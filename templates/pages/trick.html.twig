{% extends "base.html.twig" %}

{% block title %}
    Trick -
    {{parent()}}
{% endblock %}

{% block body %}
        <section id="trick-hero" class="d-flex flex-row flex-wrap align-items-center justify-content-center container-fluid px-0 position-relative pb-3 text-center">
            <img src="{{ asset('img/default_trick.jpg') }}" class="trick-img" alt="...">
            <div class="card col-md-8 p-lg-8 mx-auto catchphrase-background p-2 container position-absolute">
                <h1 class="display-4 fw-normal text-white">{{ trick.name }}</h1>
            </div>
            <div class="trick-action px-3 py-2 ms-auto me-3">
                <a href="#"><em class="mx-2 fas fa-pen text-warning"></em></a>
                <a href="#"><em class="mx-2 fas fa-trash-alt text-danger"></em></a>
            </div>
        </section>
        <section id="trick-media" class="d-flex flex-row flex-wrap justify-content-around container-fluid px-0 py-3 text-center">
            <div id="carouselExampleControls" class="carousel container slide w-100" data-bs-ride="carousel">
                <div class="carousel-inner py-2">
                    <div class="carousel-item active">
                        <div class="d-flex justify-content-center">
                            {% for i in 0..2 %}
                                <a href="#" class="col-12 col-md-3 px-2 trick">
                                    <div class="card bg-light d-flex flex-row flex-wrap card-body p-2 shadow-sm">
                                        <img class="mw-100" src="{{ asset('img/default_trick.jpg') }}" alt="Trick" />
                                    </div>
                                </a>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="carousel-item">
                        <div class="d-flex justify-content-center">
                            {% for i in 0..2 %}
                                <a href="#" class="col-12 col-md-3 px-2 trick">
                                    <div class="card bg-light d-flex flex-row flex-wrap card-body p-2 shadow-sm">
                                        <img class="mw-100" src="{{ asset('img/default_trick.jpg') }}" alt="Trick" />
                                    </div>
                                </a>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="prev">
                    <em class="fas fa-chevron-left text-primary"></em>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="next">
                    <em class="fas fa-chevron-right text-primary"></em>
                </button>
            </div>
        </section>
    <div class="container-fluid">
        <section id="trick-info" class="d-flex flex-row flex-wrap container justify-content-around my-3 py-2 text-center">
            <div class="d-flex flex-row flex-wrap justify-content-center col-12 col-md-7 mb-2">
                <h3 class="col-12 fw-bold mt-1">{{ trick.name }}</h3>
                <div class="alert alert-primary trick-category small">{{ trick.category.name }}</div>
                <small class="w-100 text-muted mb-1"><em class="fas fa-clock me-2"></em>Trick posté par <span class="fw-bold text-primary">{{ trick.user.username }}</span> le {{ trick.createdAt|date('d/m/Y à H:i') }}</small>
                <p class="col-12 text-justify">{{ trick.description }}</p>
                <button class="btn btn-outline-primary mx-auto" type="button" data-bs-toggle="collapse" data-bs-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
                    Voir l'historique des contributions
                </button>
                <div class="collapse col-12 mt-4" id="collapseExample">
                    {% for contributor in trick.contributors %}
                        <div class="w-100 ultra-small text-muted mb-1"><em class="fas fa-clock me-2"></em>Modification le {{ contributor.updatedAt|date('d/m/Y à H:i') }}  par <span class="fw-bold text-primary">{{ contributor.user.username }}</span></div>
                    {% endfor %}
                        <div class="w-100 ultra-small text-muted mb-1"><em class="fas fa-clock me-2"></em>Création le {{ trick.createdAt|date('d/m/Y à H:i') }}  par <span class="fw-bold text-primary">{{ trick.user.username }}</span></div>
                </div>
            </div>
        </section>
        <section id="trick-comments" class="d-flex flex-column flex-wrap container-fluid justify-content-around align-items-center my-3 pt-5 pb-5 text-center">
            <div class="container">
                <div class="d-sm-flex align-items-center justify-content-between mb-4">
                    <h1 class="h3 mb-0 text-gray-800 mx-2"><em class="fas fa-comments text-primary me-2"></em>Commentaires</h1>
                </div>
                {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                    <div class="text-start mb-3">
                        <span class="col-12 fw-bold text-primary"><em class="fas fa-user me-1"></em> Guy MAUVE</span>
                        <form action="ROUTE" method="POST" class="d-flex flex-row justify-content-end flex-wrap px-3">
                            <textarea class="form-control my-2" id="comment" name="comment"></textarea>
                            <input type="number" class="d-none" id="postId" name="postId" readonly value="ID" />
                            <button class="btn btn-success px-3"><em class="fas fa-paper-plane me-2"></em>Poster</button>
                        </form>
                    </div>
                {% else %}
                    <div class="alert alert-danger" role="alert">
                        <em class="fas fa-exclamation-circle me-2"></em>Vous devez être connecté pour pouvoir ajouter un commentaire
                    </div>
                {% endif %}
                {% if trick.comments is empty %}
                    <div class="small text-muted font-italic">Il n'y a pas encore de commentaire</div>
                {% else %}
                    {% for comment in trick.comments %}
                        <div class="mb-3 col-12">
                            <div class="card bg-light d-flex flex-row flex-wrap card-body p-2 shadow-sm">
                                <em class="fas fa-comment text-primary reverse-h me-1"></em><span class="fw-bold text-primary">{{ comment.user.username }}</span>
                                <span class="ms-auto text-muted">{{ comment.createdAt|date('d/m/Y à H:i') }}<em class="far fa-clock ms-1"></em></span>
                                <blockquote class="blockquote text-start col-12 m-0 px-0">
                                    <small class="card card-text border-0 text-dark col-12 p-4 mt-2">{{ comment.content }}</small>
                                </blockquote>
                            </div>
                        </div>
                    {% endfor %}
                {% endif %}

            </div>
            {% if remain_comments == true %}
            <button class="btn btn-primary w-25 mt-5" id="load-more" data-element="comment">
                <em class="fas fa-spinner"></em><br />Charger plus de commentaires
            </button>
            {% endif %}
        </section>
    </div>
{% endblock %}
